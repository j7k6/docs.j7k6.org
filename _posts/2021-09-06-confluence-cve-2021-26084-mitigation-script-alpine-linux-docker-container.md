---
layout: post
title: "Confluence CVE-2021-26084 Mitigation Script in an Alpine Linux Docker Container"
---

Atlassian recently disclosed a critical security advisory ([CVE-2021-26084](https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html)) for all Confluence Server versions on all plattforms. Although they advise installing a Confluence update immediately, this is not possible for some Confluence instances with an expired license. Luckily, Atlassian offers a mitigation script which can be run on un-update-able Confluence instances to close the security hole.

When running Cofluence Server inside a Alpine Linux Docker container, the mitigation script will not work out of the box. Here are the steps needed to successfully run the mitigation script and patch the vunerability:

1. `docker exec -it...` into the Confluence container.
2. Install required packages:
   ```bash
   apk add --update coreutils zip unzip wget vim
   ```
3. Download mitigation script:
   ```bash
   cd /tmp
   wget https://confluence.atlassian.com/doc/files/1077906215/1077916296/2/1629936383093/cve-2021-26084-update.sh
   ```
4. Edit `cve-2021-26084-update.sh`, set the `INSTALLATION_DIRECTORY` variable in line 14.
5. Set permissions:
   ```bash
   chmod 0777 /tmp/cve-2021-26084-update.sh
   ```
6. Run mitigation script:
   ```bash
   su -s /bin/bash -c "/tmp/cve-2021-26084-update.sh" confluence
   ```
7. Restart the Confluence container.

---
